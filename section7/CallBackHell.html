<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Asynchronous JavaScript</title>
</head>
<body>
    <h1>Asynchronous JavaScript</h1>
    <script>
    
       // in the next code i will show exactly how asynchronous JavaScript works behind the scenes with the event loop and the web APIs
        // and some other parts of the JavaScript Engine 

        // We are gonna build a very very small fake recipe reader. OKAY?
        // And here, we're gonna simulate ajax calls to get some fake recipes using set timeouts 
        // So basically, we're gonna simulate loading a data from a remote web server which of course would be asynchronous,
        // using some timers 

        // Now the way this is gonna work is that we simpulate first that we get a bunch of recipe IDs from a server 
        // and then based on that, we select a recipe and then get the recipe from a server after that 
        // So first, we get a couple of IDs, and then we get a recipe
        // So we are gonna use the setTimeout() function as i mentioned before,basically to simulate the ajax call 
        // so the call to get the data from the server.
        // let's simply create an array of recipe IDs and then some numbers, it doesn't really matter here
        // And again the set timeout here is just to simulate that this data here comes back from a server 
        // Now once the data comes back from the server, we then want to get the recipe for one of these IDs.
        // then we set a new timeout where then the data comes from the server for the recipe 
        // In future we will use a real API and a real AJAX call, but for now we use the set timeouts to simulate that behaviour


        // Callback hell in JavaScript : we have callback inside of callback inside of callback ... e.t.c.....
        // After sometime this situation is unmanageable 
        // Something called "promises" were introduced and with promises we can avoid all of these call back hell here
        // and have a nicer and cleaner syntax when using asynchronous JavaScript 
        function getRecipe() {
            setTimeout(() => {
                const recipeID = [523, 883, 432, 974];
                console.log(recipeID);

                setTimeout((id) => {
                    const recipe = {title: 'Fresh tomato', publisher: 'Tom'};
                    console.log(`${id}: ${recipe.title}`);

                    setTimeout(publisher => {
                        const recipe2 = {title: 'Italian Pizza', publisher: 'Jonas'};
                        console.log(recipe2);
                    }, 1500, recipe.publisher);

                }, 1500, recipeID[2]);

            }, 1500);

        }

        getRecipe();

    </script>
</body>
</html>
